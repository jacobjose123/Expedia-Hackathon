(function(){var l=Handlebars.template({1:function(c,a,e,k,f){return"tile-details-border"},compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,a,e,k,f,h,g){var b,d;return'\x3cdiv class\x3d"tile-details tile-details-v1 '+(null!=(b=e.unless.call(null!=a?a:{},f&&f.last,{name:"unless",hash:{},fn:c.program(1,f,0,h,g),inverse:c.noop,data:f}))?b:"")+'"\x3e\n    \x3cdiv class\x3d"tile-name"\x3e\n        '+c.escapeExpression((d=null!=(d=e.title||(null!=a?a.title:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"title",hash:{},data:f}):d))+'\n        \x3cdiv class\x3d"travel-date"\x3e'+c.escapeExpression((d=null!=(d=e.travelStartDate||(null!=a?a.travelStartDate:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"travelStartDate",hash:{},data:f}):d))+" - "+c.escapeExpression((d=null!=(d=e.travelEndDate||(null!=a?a.travelEndDate:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"travelEndDate",hash:{},data:f}):d))+'\x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"tile-price" id\x3d"tile-price-'+c.escapeExpression((d=null!=(d=e.lob||(null!=a?a.lob:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"lob",hash:{},data:f}):d))+"-"+c.escapeExpression((d=null!=(d=e.regionID||(null!=a?a.regionID:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"regionID",hash:{},data:f}):d))+'"\x3e\n        \x3cspan class\x3d"price"\x3e\n            '+c.escapeExpression((d=null!=(d=e.price||(null!=a?a.price:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"price",hash:{},data:f}):d))+'\n        \x3c/span\x3e\n        \x3cdiv class\x3d"per-item"\x3e\n            '+c.escapeExpression((d=null!=(d=e.perItemMessage||(null!=a?a.perItemMessage:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"perItemMessage",hash:{},data:f}):d))+'\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3ca class\x3d"flex-link  tile-link tile-'+c.escapeExpression((d=null!=(d=e.lob||(null!=a?a.lob:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"lob",hash:{},data:f}):d))+'-link" id\x3d"flex-link-'+c.escapeExpression((d=null!=(d=e.lob||(null!=a?a.lob:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"lob",hash:{},data:f}):d))+"-"+c.escapeExpression((d=null!=(d=e.regionID||(null!=a?a.regionID:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"regionID",hash:{},data:f}):d))+'" href\x3d"'+c.escapeExpression((d=null!=(d=e.url||(null!=a?a.url:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"url",hash:{},data:f}):d))+'"\n       data-region-id\x3d"'+c.escapeExpression((d=null!=(d=e.regionID||(null!=a?a.regionID:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"regionID",hash:{},data:f}):d))+'"\n       data-lob\x3d"'+c.escapeExpression((d=null!=(d=e.lob||(null!=a?a.lob:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"lob",hash:{},data:f}):d))+'"\n       data-hotel-city\x3d"'+c.escapeExpression((d=null!=(d=e.hotelCity||(null!=a?a.hotelCity:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"hotelCity",hash:{},data:f}):d))+'"\n       data-hotel-country-code\x3d"'+c.escapeExpression((d=null!=(d=e.hotelCountryCode||(null!=a?a.hotelCountryCode:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"hotelCountryCode",hash:{},data:f}):d))+'"\n       data-non-localized-city\x3d"'+c.escapeExpression((d=null!=(d=e.nonLocalizedCity||(null!=a?a.nonLocalizedCity:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"nonLocalizedCity",hash:{},data:f}):d))+'"\n       data-index\x3d"'+c.escapeExpression(c.lambda(c.data(f,1)&&c.data(f,1).index,a))+'"\x3e\n        Click here for more information about this deal and other deals for '+c.escapeExpression((d=null!=(d=e.city||(null!=a?a.city:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"city",hash:{},data:f}):d))+".\n    \x3c/a\x3e\n\x3c/div\x3e\n"},useData:!0,useDepths:!0});Handlebars.templates=Handlebars.templates||{};Handlebars.templates["dealsOptimization-landscape-design"]=l;Handlebars.partials=Handlebars.partials||{};Handlebars.partials["dealsOptimization-landscape-design"]=l})();
(function(){var l=Handlebars.template({compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,a,e,k,f,h,g){var b;return'\x3cdiv class\x3d"tile-details tile-details-v2"\x3e\n    \x3cdiv class\x3d"icon icon-'+c.escapeExpression((b=null!=(b=e.icon||(null!=a?a.icon:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"icon",hash:{},data:f}):b))+'" aria-hidden\x3d"true"\x3e\x3c/div\x3e\n    \x3cdiv class\x3d"tile-name"\x3e\n        \x3cspan class\x3d"lob-name"\x3e'+c.escapeExpression((b=null!=(b=e.title||(null!=a?a.title:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"title",hash:{},data:f}):b))+'\x3c/span\x3e\n        \x3cdiv class\x3d"travel-date"\x3e'+c.escapeExpression((b=null!=(b=e.travelStartDate||(null!=a?a.travelStartDate:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"travelStartDate",hash:{},data:f}):b))+" - "+c.escapeExpression((b=null!=(b=e.travelEndDate||(null!=a?a.travelEndDate:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"travelEndDate",hash:{},data:f}):b))+'\x3c/div\x3e\n    \x3c/div\x3e\n    \x3cdiv class\x3d"tile-price" id\x3d"tile-price-'+c.escapeExpression((b=null!=(b=e.lob||(null!=a?a.lob:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"lob",hash:{},data:f}):b))+"-"+c.escapeExpression((b=null!=(b=e.regionID||(null!=a?a.regionID:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"regionID",hash:{},data:f}):b))+'"\x3e\n        \x3cspan class\x3d"price"\x3e\n            '+c.escapeExpression((b=null!=(b=e.price||(null!=a?a.price:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"price",hash:{},data:f}):b))+'\n        \x3c/span\x3e\n        \x3cdiv class\x3d"per-item"\x3e\n            '+c.escapeExpression((b=null!=(b=e.perItemMessage||(null!=a?a.perItemMessage:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"perItemMessage",hash:{},data:f}):b))+'\n        \x3c/div\x3e\n    \x3c/div\x3e\n    \x3ca class\x3d"flex-link  tile-link tile-'+c.escapeExpression((b=null!=(b=e.lob||(null!=a?a.lob:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"lob",hash:{},data:f}):b))+'-link" id\x3d"flex-link-'+c.escapeExpression((b=null!=(b=e.lob||(null!=a?a.lob:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"lob",hash:{},data:f}):b))+"-"+c.escapeExpression((b=null!=(b=e.regionID||(null!=a?a.regionID:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"regionID",hash:{},data:f}):b))+'" href\x3d"'+c.escapeExpression((b=null!=(b=e.url||(null!=a?a.url:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"url",hash:{},data:f}):b))+'"\n       data-region-id\x3d"'+c.escapeExpression((b=null!=(b=e.regionID||(null!=a?a.regionID:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"regionID",hash:{},data:f}):b))+'"\n       data-lob\x3d"'+c.escapeExpression((b=null!=(b=e.lob||(null!=a?a.lob:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"lob",hash:{},data:f}):b))+'"\n       data-hotel-city\x3d"'+c.escapeExpression((b=null!=(b=e.hotelCity||(null!=a?a.hotelCity:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"hotelCity",hash:{},data:f}):b))+'"\n       data-hotel-country-code\x3d"'+c.escapeExpression((b=null!=(b=e.hotelCountryCode||(null!=a?a.hotelCountryCode:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"hotelCountryCode",hash:{},data:f}):b))+'"\n       data-non-localized-city\x3d"'+c.escapeExpression((b=null!=(b=e.nonLocalizedCity||(null!=a?a.nonLocalizedCity:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"nonLocalizedCity",hash:{},data:f}):b))+'"\n       data-index\x3d"'+c.escapeExpression(c.lambda(c.data(f,1)&&c.data(f,1).index,a))+'"\x3e\n        Click here for more information about this deal and other deals for '+c.escapeExpression((b=null!=(b=e.city||(null!=a?a.city:a))?b:e.helperMissing,"function"===typeof b?b.call(null!=a?a:{},{name:"city",hash:{},data:f}):b))+".\n    \x3c/a\x3e\n\x3c/div\x3e\n"},useData:!0,useDepths:!0});Handlebars.templates=Handlebars.templates||{};Handlebars.templates["dealsOptimization-portrait-design"]=l;Handlebars.partials=Handlebars.partials||{};Handlebars.partials["dealsOptimization-portrait-design"]=l})();
(function(){var l=Handlebars.template({1:function(c,a,e,k,f){return"wave1"},3:function(c,a,e,k,f){return"linear-gradient(-180deg,rgba(0,0,0,0.0) 0%, rgba(0,0,0,0.55) 100%),"},5:function(c,a,e,k,f,h,g){var b,d;return'            \x3csection class\x3d"tile-content tile-content-v1"\x3e\n                \x3cdiv class\x3d"destination-image-link-v1"\x3e\n                    \x3ca href\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.url:b,a))+'"\n                       data-region-id\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.regionID:b,a))+'"\n                       data-lob\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.lob:b,a))+'"\n                       data-hotel-city\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.hotelCity:b,a))+'"\n                       data-hotel-country-code\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.hotelCountryCode:b,a))+'"\n                       data-non-localized-city\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.nonLocalizedCity:b,a))+'"\n                       data-index\x3d"'+c.escapeExpression((d=null!=(d=e.index||f&&f.index)?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"index",hash:{},data:f}):d))+'"\x3e\n                        '+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.city:b,a))+'\n                    \x3c/a\x3e\n                \x3c/div\x3e\n                \x3cdiv class\x3d"tile-heading tile-heading-v1"\x3e'+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.city:b,a))+"\x3c/div\x3e\n"+(null!=(b=e.each.call(null!=a?a:{},null!=a?a.lobs:a,{name:"each",hash:{},fn:c.program(6,f,0,h,g),inverse:c.noop,data:f}))?b:"")+"            \x3c/section\x3e\n"},6:function(c,a,e,k,f,h,g){var b;return null!=(b=c.invokePartial(k["dealsOptimization-landscape-design"],a,{name:"dealsOptimization-landscape-design",hash:{perNight:null!=g[1]?g[1].perNight:g[1],perPerson:null!=g[1]?g[1].perPerson:g[1],wave1:null!=g[1]?g[1].wave1:g[1],city:null!=(b=null!=g[1]?g[1].destination:g[1])?b.city:b,regionID:null!=(b=null!=g[1]?g[1].destination:g[1])?b.regionID:b},data:f,indent:"                    ",helpers:e,partials:k,decorators:c.decorators}))?b:""},8:function(c,a,e,k,f,h,g){var b,d;return'            \x3ch5 class\x3d"tile-heading tile-heading-v2"\x3e'+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.city:b,a))+'\x3c/h5\x3e\n            \x3cdiv class\x3d"destination-image-link-v2"\x3e\n                \x3ca href\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.url:b,a))+'"\n                   data-region-id\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.regionID:b,a))+'"\n                   data-lob\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.lob:b,a))+'"\n                   data-hotel-city\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.hotelCity:b,a))+'"\n                   data-hotel-country-code\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.hotelCountryCode:b,a))+'"\n                   data-non-localized-city\x3d"'+c.escapeExpression(c.lambda(null!=(b=null!=(b=null!=a?a.lobs:a)?b["0"]:b)?b.nonLocalizedCity:b,a))+'"\n                   data-index\x3d"'+c.escapeExpression((d=null!=(d=e.index||f&&f.index)?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"index",hash:{},data:f}):d))+'"\x3e\n                    '+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.city:b,a))+'\n                \x3c/a\x3e\n            \x3c/div\x3e\n            \x3csection class\x3d"tile-content tile-content-v2"\x3e\n'+(null!=(b=e.each.call(null!=a?a:{},null!=a?a.lobs:a,{name:"each",hash:{},fn:c.program(9,f,0,h,g),inverse:c.noop,data:f}))?b:"")+"            \x3c/section\x3e\n"},9:function(c,a,e,k,f,h,g){var b;return null!=(b=c.invokePartial(k["dealsOptimization-portrait-design"],a,{name:"dealsOptimization-portrait-design",hash:{perNight:null!=g[1]?g[1].perNight:g[1],perPerson:null!=g[1]?g[1].perPerson:g[1],wave1:null!=g[1]?g[1].wave1:g[1],city:null!=(b=null!=g[1]?g[1].destination:g[1])?b.city:b,regionID:null!=(b=null!=g[1]?g[1].destination:g[1])?b.regionID:b},data:f,indent:"                    ",helpers:e,partials:k,decorators:c.decorators}))?b:""},compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,a,e,k,f,h,g){var b,d;return'\x3cdiv id\x3d"deals-optimization-'+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.regionID:b,a))+'" class\x3d"uitk-carousel-item uitk-col deals-optimization-tile" data-dest-index\x3d"'+c.escapeExpression((d=null!=(d=e.index||f&&f.index)?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"index",hash:{},data:f}):d))+'"\x3e\n    \x3cdiv class\x3d"flex-card flex-content flex-area-primary"\x3e\n        \x3cdiv class\x3d"tile-content-wrapper tile-height-v'+c.escapeExpression((d=null!=(d=e.experiment||(null!=a?a.experiment:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"experiment",hash:{},data:f}):d))+" "+(null!=(b=e["if"].call(null!=a?a:{},null!=(b=null!=a?a.wave1:a)?b.isWave1Country:b,{name:"if",hash:{},fn:c.program(1,f,0,h,g),inverse:c.noop,data:f}))?b:"")+'"\n             style\x3d"background-image:'+(null!=(b=e["if"].call(null!=a?a:{},null!=a?a.isV1:a,{name:"if",hash:{},fn:c.program(3,f,0,h,g),inverse:c.noop,data:f}))?b:"")+"url('//a.travel-assets.com/dynamic_destination_images/exact/crop/"+c.escapeExpression(c.lambda(null!=(b=null!=a?a.destination:a)?b.regionID:b,a))+".jpg?width\x3d264\x26height\x3d330\x26compress\x3dtrue\x26fallbackSource\x3dTM')\"\x3e\n"+(null!=(b=e["if"].call(null!=a?a:{},null!=a?a.isV1:a,{name:"if",hash:{},fn:c.program(5,f,0,h,g),inverse:c.program(8,f,0,h,g),data:f}))?b:"")+'        \x3c/div\x3e\n        \x3cdiv class\x3d"default-img"\x3e\x3c/div\x3e\n    \x3c/div\x3e\n\x3c/div\x3e\n'},usePartial:!0,useData:!0,useDepths:!0});Handlebars.templates=Handlebars.templates||{};Handlebars.templates["dealsOptimization-deal"]=l;Handlebars.partials=Handlebars.partials||{};Handlebars.partials["dealsOptimization-deal"]=l})();
(function(){var l=Handlebars.template({1:function(c,a,e,k,f,h,g){var b,d;return'\x3cdiv id\x3d"deals-optimization-wrapper"\x3e\n    \x3cspan class\x3d"visuallyhidden" role\x3d"heading" aria-level\x3d"2"\x3e'+c.escapeExpression((d=null!=(d=e.dealsOptimizationTitle||(null!=a?a.dealsOptimizationTitle:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"dealsOptimizationTitle",hash:{},data:f}):d))+'\x3c/span\x3e\n    \x3cheader class\x3d"cols-row-header section-header cf"\x3e\n        \x3ch3 id\x3d"deals-optimization-title" class\x3d"section-header-main"\x3e'+c.escapeExpression((d=null!=(d=e.dealsOptimizationTitle||(null!=a?a.dealsOptimizationTitle:a))?d:e.helperMissing,"function"===typeof d?d.call(null!=a?a:{},{name:"dealsOptimizationTitle",hash:{},data:f}):d))+'\x3c/h3\x3e\n    \x3c/header\x3e\n    \x3csection id\x3d"deals-optimization-carousel" class\x3d"uitk-carousel '+(null!=(b=e["if"].call(null!=a?a:{},null!=a?a.isMobile:a,{name:"if",hash:{},fn:c.program(2,f,0,h,g),inverse:c.noop,data:f}))?b:"")+'" data-control\x3d"uitk-carousel"\x3e\n        \x3cdiv class\x3d"uitk-carousel-wrap"\x3e\n            \x3cdiv class\x3d"uitk-carousel-items uitk-grid all-grid-nowrap mobile-col-1-1 smalltablet-col-1-2 tablet-col-1-3 desktop-col-1-4 all-x-gutter-12 deals-optimization-tile-grid"\x3e\n'+(null!=(b=e.each.call(null!=a?a:{},null!=a?a.displayDeals:a,{name:"each",hash:{},fn:c.program(4,f,0,h,g),inverse:c.noop,data:f}))?b:"")+"            \x3c/div\x3e\n        \x3c/div\x3e\n    \x3c/section\x3e\n\x3c/div\x3e\n"},2:function(c,a,e,k,f){return"all-carousel-peek"},4:function(c,a,e,k,f,h,g){var b;return null!=(b=c.invokePartial(k["dealsOptimization-deal"],a,{name:"dealsOptimization-deal",hash:{perNight:null!=g[1]?g[1].perNight:g[1],perPerson:null!=g[1]?g[1].perPerson:g[1],wave1:null!=g[1]?g[1].wave1:g[1],isV1:null!=g[1]?g[1].isV1:g[1],experiment:null!=g[1]?g[1].experiment:g[1]},data:f,indent:"                    ",helpers:e,partials:k,decorators:c.decorators}))?b:""},compiler:[7,"\x3e\x3d 4.0.0"],main:function(c,a,e,k,f,h,g){var b;return null!=(b=e["if"].call(null!=a?a:{},null!=(b=null!=a?a.displayDeals:a)?b.length:b,{name:"if",hash:{},fn:c.program(1,f,0,h,g),inverse:c.noop,data:f}))?b:""},usePartial:!0,useData:!0,useDepths:!0});Handlebars.templates=Handlebars.templates||{};Handlebars.templates["dealsOptimization-container"]=l;Handlebars.partials=Handlebars.partials||{};Handlebars.partials["dealsOptimization-container"]=l})();define("dealsOptimization-loc",function(){return{dealsOptimizationTitle:"Discover Deals",flightPlusHotel:"Flight + Hotel",hotelOnly:"Hotel only",priceFrom:"from {{price}}",perPerson:"per person",perNight:"per night",perRoom:"per room"}});define("dealsOptimizationUtils",["dealsOptimization-loc","uitk","uitk_localized_dateApi","uitk_localized_priceApi","uitk_localized_config"],function(l,c){return{calculateDate:function(a,c,k){a=new Date(a.getTime());c=7*c+(k-a.getDay());return new Date(a.setDate(a.getDate()+c))},convertDateToString:function(a){var c=a.getDate(),k=a.getMonth()+1;c=10>c?"0"+c:c;k=10>k?"0"+k:k;return a.getFullYear()+"-"+k+"-"+c},formatPrice:function(a,e){return"string"===typeof a?a:c.utils.createLocalizedPrice(a.toString(),window.locale,e).roundUp().format()},formatDate:function(a){return"undefined"===typeof a||3!==a.length?null:c.utils.createLocalizedDate(a[2]+"/"+a[1]+"/"+a[0],window.locale).mediumDate()}}});define("dealsOptimizationModelBuilder",["underscore","dealsOptimizationUtils","dealsOptimization-loc"],function(l,c,a){function e(e,f,h,g){var b={};e(b,a,c,f,h,g);b.travelStartDate=c.formatDate(f.offerDateRange.travelStartDate);b.travelEndDate=c.formatDate(f.offerDateRange.travelEndDate);return b}return{buildDeals:function(a,c,h,g,b,d){var f=0,k=[];l.each(c,function(c){if(f<h&&void 0===l.find(g,function(a){return a===c.destination.regionID})){var p={index:1};p.destination=c.destination;p.lobs=[];p.lobs.push(e(a,c,b,d));k.push(p);f+=1;g.push(c.destination.regionID)}});return k},updateBuildDeals:function(a,c,h,g,b,d,m){var f=c.length;l.each(h,function(k){var h=l.find(c,function(a){return a.destination.regionID===k.destination.regionID});void 0!==h?(h.index=0,h.lobs=h.lobs||[],2>h.lobs.length&&h.lobs.unshift(e(a,k,d,m))):f<g&&void 0===l.find(b,function(a){return a===k.destination.regionID})&&(h={index:1},h.destination=k.destination,h.lobs=[],h.lobs.unshift(e(a,k,d,m)),c.push(h),b.push(k.destination.regionID),f+=1)});return c}}});define("dealsOptimizationPackage",["dealsOptimizationModelBuilder"],function(l){function c(a,c,k,f,h){a.icon="packages";a.lob="package";a.title=c.flightPlusHotel;a.isPackage=!0;a.price=k.formatPrice(f.packagePricingInfo.perPsgrPackagePrice,h);a.perItemMessage=c.perPerson;a.url=decodeURIComponent(f.packageUrls.packageSearchUrl);a.hotelCity=f.hotelInfo.hotelCity;a.hotelCountryCode=f.hotelInfo.hotelCountryCode;a.nonLocalizedCity=""}return{displayDeals:function(a,e,k,f){return l.buildDeals(c,a,e,k,f,!1)},updateDisplayDeals:function(a,e,k,f,h){return l.updateBuildDeals(c,a,e,k,f,h,!1)}}});define("dealsOptimizationHotel",["dealsOptimizationModelBuilder"],function(l){function c(a,c,k,f,h,g){a.icon="hotels";a.lob="hotel";a.isPackage=!1;a.title=c.hotelOnly;a.price=g?k.formatPrice(f.hotelPricingInfo.totalPriceValue,h):k.formatPrice(f.hotelPricingInfo.averagePriceValue,h);a.perItemMessage=g?c.perRoom:c.perNight;a.url=decodeURIComponent(f.hotelUrls.hotelSearchResultUrl);a.hotelCity=f.hotelInfo.hotelCity;a.hotelCountryCode=f.hotelInfo.hotelCountryCode;a.nonLocalizedCity=f.destination.nonLocalizedCity}return{displayDeals:function(a,e,k,f,h){return l.buildDeals(c,a,e,k,f,h)}}});define("dealsOptimizationOmniture",["jquery","uitk","dctk/dctk","storefrontPageModel"],function(l,c,a,e){return{dealOptimizationClickTracking:function(k){var f=JSON.parse(e.omnitureJson).omnitureProperties,h={},g="INTL",b="HOT";h.trackVars={};h.name="deals_optimization";h.trackVars=f;h.trackEvents="event201";l(document).on(c.clickEvent,".deals-optimization-tile a",function(c){c=l(c.target);var d=c.attr("data-index"),e=c.attr("data-non-localized-city");""===e&&(e=c.attr("data-hotel-city"));var f=c.attr("data-hotel-country-code");k===f&&(g="DOM");-1!==c.attr("class").toString().indexOf("package")&&(b="PKG");h.rfrr="HP.DealsOpt.C1."+b+"."+(parseInt(d,10)+1)+"."+g+"."+e;a.onReady(function(){a.trackEvent(h)})})}}});
define("dealsOptimization","jquery underscore uitk handlebars sfAbTest dealsOptimization-loc dealsOptimizationUtils dealsOptimizationPackage dealsOptimizationHotel dealsOptimizationOmniture".split(" "),function(l,c,a,e,k,f,h,g,b,d){var m=m||{},n="USD",q={clientId:"merchwebstorefront",responseType:"jsonp",page:"homepage",pageNumber:1,siteId:siteid,locale:locale,key:"90b170db-5df5-43cd-b8ba-6cd8b1382762"};m.config={container:l("#deals-optimization-container"),containerCarouselId:"#deals-optimization-carousel"};m.render=function(a,b){var c=e.partials["dealsOptimization-container"],d=null!=navigator.userAgent.match(/Mobile|iPhone|Android|BlackBerry/i);m.config.container.html(c({displayDeals:a,dealsOptimizationTitle:f.dealsOptimizationTitle,isMobile:d,experiment:b,isV1:1==b}));l(m.config.containerCarouselId).uitk_carousel()};m.getReferencePriceCriteria=function(){var a=h.calculateDate(new Date,3,5),b=h.calculateDate(a,4,4),c=m.config.container.data("islocationinposcountry"),d=m.config.container.data("islocationinpopularcity"),e=m.config.container.data("countrycode3letters"),f=m.config.container.data("city"),g=l.extend({},q);g.uid=-1;g.productType="Package|Hotel";g.minStarRating=3;g.lengthOfStay=3;g.minTripStartDate=h.convertDateToString(a);g.maxTripStartDate=h.convertDateToString(b);g.maxCountPerDestination=1;g.enabledFeatureGates="dealFinderPackageOriginSelectionFallback";"undefined"!==typeof c&&c&&("undefined"!==typeof d&&d?g.originCity=f:g.originCountry=e);return g};m.getDisplayDeals=function(a){var d=[],e=[],f=m.config.container.data("iswave1country");f="undefined"!==typeof f?f:!1;n=a.offerInfo.userSelectedCurrency?a.offerInfo.userSelectedCurrency:a.offerInfo.currency;if(void 0!==a.offers){var h=a.offers.Hotel;void 0!==h&&(d=b.displayDeals(h,12,e,n,f));a=a.offers.Package;void 0!==a&&(d=0==d.length?g.displayDeals(a,12,e,n):g.updateDisplayDeals(d,a,12,e,n))}return c.sortBy(d,"index")};m.init=function(a){l.ajax({url:"https://apim.expedia.com/offers/deals/v2",data:m.getReferencePriceCriteria(),type:"GET",dataType:"jsonp",cache:!1,timeout:5E3}).then(function(b){m.callback(b,a);d.dealOptimizationClickTracking(m.config.container.data("countrycode3letters"))}).always(function(a,b){var c={status:b};"success"===b&&"object"===typeof a&&"string"===typeof a.offers&&0<a.offers.length&&("string"===typeof a.offers.Package?c.hasPackageDeals=!0:"string"===typeof a.offers.Hotel&&(c.hasHotelDeals=!0));window.dctk&&dctk.enabled&&dctk.logging&&dctk.logging.logError?dctk.logging.logMessage("sf-web:deals-optimization",c):require("dctk/clientLogging",function(a){a.logMessage("sf-web:deals-optimization",c)})})};m.callback=function(a,b){"undefined"===typeof a||"undefined"===typeof a.offers||"undefined"===typeof a.offers.Package&&"undefined"===typeof a.offers.Hotel||m.render(m.getDisplayDeals(a),b)};m.evaluatePreconditions=function(){var a=l.Deferred();k.get(25146,!1).then(function(b){return 1==b.value?k.get(24834,!0):a.reject()}).then(function(b){1==b.value||2==b.value?a.resolve(b.value):a.reject()});return a.promise()};return m});require(["dealsOptimization"],function(l){l.evaluatePreconditions().then(function(c){l.init(c)})});var test={};
//# sourceMappingURL=dealsOptimization-27-en_GB.js.map